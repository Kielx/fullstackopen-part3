{"version":3,"sources":["components/PersonsDBService.js","components/PersonsList.js","components/Input.js","components/PhonebookForm.js","components/Filter.js","index.js"],"names":["create","newObject","persons","setPersons","displayMessage","personObject","a","axios","post","res","concat","data","name","phone","delPerson","id","setErrorMessage","personName","Object","values","forEach","person","window","confirm","delete","then","response","pr","status","statusText","filter","catch","err","db","setTimeout","get","patchPersonNumber","setSuccessMessage","newPhoneNumber","existingPerson","newName","patch","index","indexOf","temp","PersonsList","filteredPersons","newPersons","map","key","type","className","onClick","PersonsDBService","Input","val","changeHandler","htmlFor","value","onChange","PhonebookForm","setNewName","setNewPhoneNumber","handleNewNameAdd","event","target","Filter","setFilter","App","useState","filterResult","setFilterResult","errorMessage","successMessage","isMessageDisplayed","setIsMessageDisplayed","messageType","message","msg","Error","clearTimeout","timeout","clearInputs","useEffect","toLowerCase","includes","changeFilterResult","preventDefault","exists","personsDBService","Alert","variant","Spinner","animation","role","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.b1010edc.chunk.js","sourcesContent":["import axios from \"axios\";\n\nconst baseUrl = \"/api/persons\" || \"http://localhost:3001/api/persons\";\n\nconst create = async (\n  newObject,\n  persons,\n  setPersons,\n  displayMessage,\n  personObject\n) => {\n  try {\n    const res = await axios.post(baseUrl, newObject);\n    setPersons(persons.concat(res.data));\n    displayMessage(\n      \"success\",\n      `${personObject.name} with phone number ${personObject.phone} was successfully created`\n    );\n  } catch (e) {\n    displayMessage(\"error\", \"Data provided is invalid\");\n  }\n};\n\nconst delPerson = (id, persons, setPersons, setErrorMessage) => {\n  let personName;\n  Object.values(persons).forEach((person) => {\n    if (person.id === id) {\n      personName = person.name;\n    }\n  });\n  if (window.confirm(`Do you really want to delete ${personName}?`)) {\n    axios\n      .delete(`${baseUrl}/${id}`)\n      .then((response, pr) => {\n        if (response.status === 200 && response.statusText === \"OK\") {\n          pr = persons.filter((person) => person.id !== id);\n          setPersons(pr);\n        }\n      })\n      .catch((err, db) => {\n        setErrorMessage(`${personName} does not exist!`);\n        setTimeout(() => {\n          setErrorMessage(\"\");\n        }, 5000);\n\n        db = axios.get(`${baseUrl}`);\n        db.then((res) => {\n          setPersons(res.data);\n        });\n      });\n  }\n};\n\nconst patchPersonNumber = (\n  persons,\n  setPersons,\n  setSuccessMessage,\n  newPhoneNumber,\n  existingPerson,\n  newName\n) => {\n  let res = axios.patch(`http://localhost:3001/persons/${existingPerson.id}`, {\n    phone: newPhoneNumber,\n  });\n  res.then((res) => {\n    let index = persons.indexOf(existingPerson);\n    let temp = [...persons];\n    temp[index] = res.data;\n    setPersons(temp);\n\n    setSuccessMessage(\n      `${newName} phone number was updated to ${newPhoneNumber} successfully!`\n    );\n    setTimeout(() => {\n      setSuccessMessage(\"\");\n    }, 5000);\n  });\n};\n\nexport default { create, delPerson, patchPersonNumber };\n","import React from \"react\";\nimport PersonsDBService from \"./PersonsDBService\";\n\nconst PersonsList = ({\n  persons,\n  filteredPersons,\n  setPersons,\n  setErrorMessage,\n}) => {\n  const newPersons = filteredPersons.map((person) => (\n    <div key={person.id}>\n      <li id={person.id}>\n        {person.name} {person.phone}\n      </li>\n      <button\n        type=\"button\"\n        className=\"btn btn-danger btn-sm\"\n        onClick={() => {\n          PersonsDBService.delPerson(\n            person.id,\n            persons,\n            setPersons,\n            setErrorMessage\n          );\n        }}\n      >\n        Delete\n      </button>\n    </div>\n  ));\n  return <ul>{newPersons}</ul>;\n};\n\nexport default PersonsList;\n","import React from \"react\";\n\nconst Input = ({ val, changeHandler, name }) => {\n  return (\n    <div>\n      <label htmlFor={name}>{name}</label>\n      <input id={name} value={val} onChange={changeHandler} />\n    </div>\n  );\n};\n\nexport default Input;\n","import React from \"react\";\nimport Input from \"./Input\";\n\nexport default function PhonebookForm({\n  newName,\n  newPhoneNumber,\n  setNewName,\n  setNewPhoneNumber,\n  handleNewNameAdd,\n}) {\n  const handleNameChange = (event) => {\n    setNewName(event.target.value);\n  };\n\n  const handleNewPhoneNumber = (event) => {\n    setNewPhoneNumber(event.target.value);\n  };\n\n  return (\n    <form>\n      <Input\n        val={newName}\n        changeHandler={handleNameChange}\n        name={\"Name:\"}\n      ></Input>\n      <Input\n        val={newPhoneNumber}\n        changeHandler={handleNewPhoneNumber}\n        name={\"Phone number:\"}\n      ></Input>\n      <button\n        type=\"button\"\n        className=\"btn btn-primary\"\n        onClick={handleNewNameAdd}\n      >\n        Add new phonebook record\n      </button>\n    </form>\n  );\n}\n","import React from \"react\";\nimport Input from \"./Input\";\n\nconst Filter = ({ filter, setFilter }) => {\n  const handleFilter = (event) => {\n    setFilter(event.target.value);\n  };\n\n  return (\n    <Input\n      val={filter}\n      changeHandler={handleFilter}\n      name={\"Filter results\"}\n    ></Input>\n  );\n};\n\nexport default Filter;\n","import React, { useState, useEffect } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport axios from \"axios\";\nimport \"./index.css\";\n\nimport Spinner from \"react-bootstrap/Spinner\";\nimport Alert from \"react-bootstrap/Alert\";\n\nimport PersonsList from \"./components/PersonsList\";\nimport PhonebookForm from \"./components/PhonebookForm\";\nimport personsDBService from \"./components/PersonsDBService\";\nimport Filter from \"./components/Filter\";\n\nconst App = () => {\n  //state\n  const [persons, setPersons] = useState(\"\");\n  const [newName, setNewName] = useState(\"\");\n  const [newPhoneNumber, setNewPhoneNumber] = useState(\"\");\n  const [filter, setFilter] = useState(\"\");\n  const [filterResult, setFilterResult] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [successMessage, setSuccessMessage] = useState(\"\");\n  const [isMessageDisplayed, setIsMessageDisplayed] = useState(false);\n\n  //helper functions\n\n  const displayMessage = (messageType, message) => {\n    let msg = \"\";\n    switch (messageType) {\n      case \"error\":\n        msg = setErrorMessage;\n        setErrorMessage(message);\n        setSuccessMessage(\"\");\n        break;\n      case \"success\":\n        msg = setSuccessMessage;\n        setSuccessMessage(message);\n        setErrorMessage(\"\");\n        break;\n      default:\n        throw new Error(\"Invalid message type\");\n    }\n    if (isMessageDisplayed) {\n      clearTimeout(isMessageDisplayed);\n    }\n    let timeout = setTimeout(() => {\n      msg(\"\");\n      setIsMessageDisplayed(false);\n    }, 5000);\n    setIsMessageDisplayed(timeout);\n  };\n\n  const clearInputs = () => {\n    setNewName(\"\");\n    setNewPhoneNumber(\"\");\n  };\n\n  const handleNewNameAdd = (event) => {\n    event.preventDefault();\n    let existingPerson;\n    let exists = false;\n    persons.forEach((person) => {\n      if (Object.values(person).includes(newName)) {\n        exists = true;\n        existingPerson = person;\n      }\n    });\n    if (\n      exists &&\n      window.confirm(\n        `The name ${existingPerson.name} already exists, do you want to update the phone number for selected person?`\n      )\n    ) {\n      personsDBService.patchPersonNumber(\n        persons,\n        setPersons,\n        setSuccessMessage,\n        newPhoneNumber,\n        existingPerson,\n        newName\n      );\n      clearInputs();\n    } else {\n      const personObject = {\n        name: newName,\n        phone: newPhoneNumber,\n      };\n      personsDBService.create(\n        personObject,\n        persons,\n        setPersons,\n        displayMessage,\n        personObject\n      );\n      clearInputs();\n    }\n  };\n\n  //useEffect\n\n  useEffect(() => {\n    let db = axios.get(\"/api/persons\");\n    db.then((res) => {\n      setPersons(res.data);\n    });\n  }, []);\n\n  useEffect(() => {\n    const changeFilterResult = () => {\n      let filteredPersons = persons.filter((person) => {\n        return person.name.toLowerCase().includes(filter.toLowerCase());\n      });\n      return setFilterResult(filteredPersons);\n    };\n    if (persons) {\n      changeFilterResult();\n    } else {\n      setFilterResult(\"\");\n    }\n  }, [filter, persons]);\n\n  return (\n    <div>\n      <Filter filter={filter} setFilter={setFilter} />\n      <h2>Phonebook</h2>\n      <PhonebookForm\n        newName={newName}\n        newPhoneNumber={newPhoneNumber}\n        setNewName={setNewName}\n        setNewPhoneNumber={setNewPhoneNumber}\n        handleNewNameAdd={handleNewNameAdd}\n      ></PhonebookForm>\n      <h2>Numbers</h2>\n      {successMessage ? (\n        <Alert variant=\"success\">{successMessage}</Alert>\n      ) : null}\n      {errorMessage ? <Alert variant=\"danger\">{errorMessage}</Alert> : null}\n      {typeof filterResult === \"object\" ? (\n        <PersonsList\n          persons={persons}\n          filteredPersons={filterResult}\n          setPersons={setPersons}\n          setErrorMessage={setErrorMessage}\n        ></PersonsList>\n      ) : (\n        <Spinner animation=\"border\" role=\"status\">\n          <span className=\"sr-only\">Loading...</span>\n        </Spinner>\n      )}\n    </div>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}