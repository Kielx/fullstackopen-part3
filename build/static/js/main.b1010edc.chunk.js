(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{27:function(e,t,n){e.exports=n(53)},49:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n(0),c=n.n(r),o=n(8),s=n.n(o),u=n(6),l=n.n(u),i=(n(49),n(25)),m=n(14),f=n(26),d=n(13),b=n.n(d),p=n(24),h={create:function(){var e=Object(p.a)(b.a.mark((function e(t,n,a,r,c){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.post("/api/persons",t);case 3:o=e.sent,a(n.concat(o.data)),r("success","".concat(c.name," with phone number ").concat(c.phone," was successfully created")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r("error","Data provided is invalid");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,a,r,c){return e.apply(this,arguments)}}(),delPerson:function(e,t,n,a){var r;Object.values(t).forEach((function(t){t.id===e&&(r=t.name)})),window.confirm("Do you really want to delete ".concat(r,"?"))&&l.a.delete("".concat("/api/persons","/").concat(e)).then((function(a,r){200===a.status&&"OK"===a.statusText&&(r=t.filter((function(t){return t.id!==e})),n(r))})).catch((function(e,t){a("".concat(r," does not exist!")),setTimeout((function(){a("")}),5e3),l.a.get("".concat("/api/persons")).then((function(e){n(e.data)}))}))},patchPersonNumber:function(e,t,n,a,r,c){l.a.patch("http://localhost:3001/persons/".concat(r.id),{phone:a}).then((function(o){var s=e.indexOf(r),u=Object(f.a)(e);u[s]=o.data,t(u),n("".concat(c," phone number was updated to ").concat(a," successfully!")),setTimeout((function(){n("")}),5e3)}))}},v=function(e){var t=e.persons,n=e.filteredPersons,a=e.setPersons,r=e.setErrorMessage,o=n.map((function(e){return c.a.createElement("div",{key:e.id},c.a.createElement("li",{id:e.id},e.name," ",e.phone),c.a.createElement("button",{type:"button",className:"btn btn-danger btn-sm",onClick:function(){h.delPerson(e.id,t,a,r)}},"Delete"))}));return c.a.createElement("ul",null,o)},E=function(e){var t=e.val,n=e.changeHandler,a=e.name;return c.a.createElement("div",null,c.a.createElement("label",{htmlFor:a},a),c.a.createElement("input",{id:a,value:t,onChange:n}))};function w(e){var t=e.newName,n=e.newPhoneNumber,a=e.setNewName,r=e.setNewPhoneNumber,o=e.handleNewNameAdd;return c.a.createElement("form",null,c.a.createElement(E,{val:t,changeHandler:function(e){a(e.target.value)},name:"Name:"}),c.a.createElement(E,{val:n,changeHandler:function(e){r(e.target.value)},name:"Phone number:"}),c.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:o},"Add new phonebook record"))}var O=function(e){var t=e.filter,n=e.setFilter;return c.a.createElement(E,{val:t,changeHandler:function(e){n(e.target.value)},name:"Filter results"})},j=function(){var e=Object(r.useState)(""),t=Object(a.a)(e,2),n=t[0],o=t[1],s=Object(r.useState)(""),u=Object(a.a)(s,2),f=u[0],d=u[1],b=Object(r.useState)(""),p=Object(a.a)(b,2),E=p[0],j=p[1],N=Object(r.useState)(""),g=Object(a.a)(N,2),y=g[0],P=g[1],k=Object(r.useState)(""),x=Object(a.a)(k,2),S=x[0],T=x[1],C=Object(r.useState)(""),D=Object(a.a)(C,2),F=D[0],H=D[1],A=Object(r.useState)(""),L=Object(a.a)(A,2),I=L[0],J=L[1],M=Object(r.useState)(!1),B=Object(a.a)(M,2),K=B[0],q=B[1],z=function(e,t){var n="";switch(e){case"error":n=H,H(t),J("");break;case"success":n=J,J(t),H("");break;default:throw new Error("Invalid message type")}K&&clearTimeout(K);var a=setTimeout((function(){n(""),q(!1)}),5e3);q(a)},G=function(){d(""),j("")};return Object(r.useEffect)((function(){l.a.get("/api/persons").then((function(e){o(e.data)}))}),[]),Object(r.useEffect)((function(){n?function(){var e=n.filter((function(e){return e.name.toLowerCase().includes(y.toLowerCase())}));T(e)}():T("")}),[y,n]),c.a.createElement("div",null,c.a.createElement(O,{filter:y,setFilter:P}),c.a.createElement("h2",null,"Phonebook"),c.a.createElement(w,{newName:f,newPhoneNumber:E,setNewName:d,setNewPhoneNumber:j,handleNewNameAdd:function(e){var t;e.preventDefault();var a=!1;if(n.forEach((function(e){Object.values(e).includes(f)&&(a=!0,t=e)})),a&&window.confirm("The name ".concat(t.name," already exists, do you want to update the phone number for selected person?")))h.patchPersonNumber(n,o,J,E,t,f),G();else{var r={name:f,phone:E};h.create(r,n,o,z,r),G()}}}),c.a.createElement("h2",null,"Numbers"),I?c.a.createElement(m.a,{variant:"success"},I):null,F?c.a.createElement(m.a,{variant:"danger"},F):null,"object"===typeof S?c.a.createElement(v,{persons:n,filteredPersons:S,setPersons:o,setErrorMessage:H}):c.a.createElement(i.a,{animation:"border",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")))};s.a.render(c.a.createElement(j,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.b1010edc.chunk.js.map