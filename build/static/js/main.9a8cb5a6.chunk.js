(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{27:function(e,t,n){e.exports=n(53)},49:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n(0),c=n.n(r),o=n(8),s=n.n(o),u=n(6),l=n.n(u),i=(n(49),n(25)),m=n(15),d=n(26),f=n(10),p=n.n(f),b=n(14),h="/api/persons",v={create:function(){var e=Object(b.a)(p.a.mark((function e(t,n,a,r,c){var o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.post(h,t);case 3:o=e.sent,a(n.concat(o.data)),r("success","".concat(c.name," with phone number ").concat(c.phone," was successfully created")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r("error","Data provided is invalid");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,a,r,c){return e.apply(this,arguments)}}(),delPerson:function(e,t,n,a){var r,c;Object.values(t).forEach((function(t){t._id===e&&(r=t.name,c=t.phone)})),window.confirm("Do you really want to delete ".concat(r,"?"))&&l.a.delete("".concat(h,"/").concat(e)).then((function(o,s){200===o.status&&"OK"===o.statusText&&(s=t.filter((function(t){return t._id!==e})),n(s),a("success","".concat(r," with phone number ").concat(c," was successfully deleted!")))})).catch((function(e,t){a("error","Selected user does not exist!"),l.a.get("".concat(h)).then((function(e){n(e.data)}))}))},patchPersonNumber:function(){var e=Object(b.a)(p.a.mark((function e(t,n,a,r,c){var o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.patch("".concat(h,"/").concat(c._id),{phone:r});case 3:o=e.sent,a("success","".concat(c.name," phone number was successfully updated to ").concat(r)),(s=Object(d.a)(t)).forEach((function(e){e._id===o.data._id&&(e.phone=r)})),n(s),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),a("error","Error ocurred while trying to change person number"),l.a.get("".concat(h)).then((function(e){n(e.data)}));case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,a,r,c){return e.apply(this,arguments)}}()},w=function(e){var t=e.persons,n=e.filteredPersons,a=e.setPersons,r=e.displayMessage,o=n.map((function(e){return c.a.createElement("div",{key:e._id},c.a.createElement("li",{id:e._id},e.name," ",e.phone),c.a.createElement("button",{type:"button",className:"btn btn-danger btn-sm",onClick:function(){v.delPerson(e._id,t,a,r)}},"Delete"))}));return c.a.createElement("ul",null,o)},E=function(e){var t=e.val,n=e.changeHandler,a=e.name;return c.a.createElement("div",null,c.a.createElement("label",{htmlFor:a},a),c.a.createElement("input",{id:a,value:t,onChange:n}))};function j(e){var t=e.newName,n=e.newPhoneNumber,a=e.setNewName,r=e.setNewPhoneNumber,o=e.handleNewNameAdd;return c.a.createElement("form",null,c.a.createElement(E,{val:t,changeHandler:function(e){a(e.target.value)},name:"Name:"}),c.a.createElement(E,{val:n,changeHandler:function(e){r(e.target.value)},name:"Phone number:"}),c.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:o},"Add new phonebook record"))}var O=function(e){var t=e.filter,n=e.setFilter;return c.a.createElement(E,{val:t,changeHandler:function(e){n(e.target.value)},name:"Filter results"})},N=function(){var e=Object(r.useState)(""),t=Object(a.a)(e,2),n=t[0],o=t[1],s=Object(r.useState)(""),u=Object(a.a)(s,2),d=u[0],f=u[1],p=Object(r.useState)(""),b=Object(a.a)(p,2),h=b[0],E=b[1],N=Object(r.useState)(""),g=Object(a.a)(N,2),y=g[0],k=g[1],P=Object(r.useState)(""),x=Object(a.a)(P,2),S=x[0],_=x[1],C=Object(r.useState)(""),D=Object(a.a)(C,2),F=D[0],H=D[1],T=Object(r.useState)(""),A=Object(a.a)(T,2),L=A[0],I=A[1],J=Object(r.useState)(!1),M=Object(a.a)(J,2),B=M[0],K=M[1],q=function(e,t){var n="";switch(e){case"error":n=H,H(t),I("");break;case"success":n=I,I(t),H("");break;default:throw new Error("Invalid message type")}B&&clearTimeout(B);var a=setTimeout((function(){n(""),K(!1)}),5e3);K(a)},z=function(){f(""),E("")};return Object(r.useEffect)((function(){l.a.get("/api/persons").then((function(e){o(e.data)}))}),[]),Object(r.useEffect)((function(){n?function(){var e=n.filter((function(e){return e.name.toLowerCase().includes(y.toLowerCase())}));_(e)}():_("")}),[y,n]),c.a.createElement("div",null,c.a.createElement(O,{filter:y,setFilter:k}),c.a.createElement("h2",null,"Phonebook"),c.a.createElement(j,{newName:d,newPhoneNumber:h,setNewName:f,setNewPhoneNumber:E,handleNewNameAdd:function(e){var t;e.preventDefault();var a=!1;if(n.forEach((function(e){Object.values(e).includes(d)&&(a=!0,t=e)})),a&&window.confirm("The name ".concat(t.name," already exists, do you want to update the phone number for selected person?")))v.patchPersonNumber(n,o,q,h,t,d),z();else{var r={name:d,phone:h};v.create(r,n,o,q,r),z()}}}),c.a.createElement("h2",null,"Numbers"),L?c.a.createElement(m.a,{variant:"success"},L):null,F?c.a.createElement(m.a,{variant:"danger"},F):null,"object"===typeof S?c.a.createElement(w,{persons:n,filteredPersons:S,setPersons:o,displayMessage:q}):c.a.createElement(i.a,{animation:"border",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")))};s.a.render(c.a.createElement(N,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.9a8cb5a6.chunk.js.map